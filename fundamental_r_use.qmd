---
title: "Fundamentals of R"
format: html
editor: visual
toc: true
---

## Introduction

This chapter will go over the fundamental tools you will need in order to work in R and to create projects and to experiment with the building blocks of Rstudio. If you have not already gone to chapter one that teaches you how to set up Rstudio do that now.

-   How to use packages and what you will need to do in order to update them.

-   How to create and manipulate data.

-   How to use functions, objects, and pipes.

-   Common errors and different ways to deal with them.

-   And the main types of data that you will be running into in Rstudio.

## Rstudio Overview

Once you open Rstudio you might notice that there are four different panes on your screen that each look different from the other. Although it might look overwhelming these panes are all important when operating in Rstudio and will all be used.

### Console Frame

The console frame is the **bottom left frame on your screen**. Think of this frame as a chat box in R in order to see behind the scenes of what you will be running. You should make note that the console is like a scrap piece of paper or and etch an sketch its a great place to do some troubleshooting or viewing data through the `glimpse()` function but **any work you do here will not be saved.** This is where you will be viewing some of your code. You can also see outputs from your code directly in this frame and is one location of where you will be troubleshooting as well. The console is also next to the terminal which is the tab right next to it. **They both can run commands but are different in nature**.The *console* is intended to run commands that work mainly inside Rstudio itself. The *terminal* however runs systems commands like something you do on your computer.

```{r, echo=FALSE}
knitr::include_graphics("images/R_console_screenshot.png")
```

### Source Frame

The source frame or editor frame is **the top left frame** on your screen. This frame is the primary location of where you will be doing your work and typing all of your code. The source frame is used to open RMarkdown documents, scripts, and other ways to type code. You can also save and open new documents and files at the farthest top left corner of this frame.

```{r, echo=FALSE}
knitr::include_graphics("images/source_screenshot_example.png")
```

### Environment/History

The environment or history frame can be seen in **the top right frame on your screen.** This is where you can view current objects that you have created which we will discuss further in the chapter as well as data sets and where you can track your steps by viewing the command history that you have run.

```{r, echo=FALSE}
knitr::include_graphics("images/Environment_screenshot_example.png")
```

### Files/Packages

The last frame on **the bottom right is your files and packages** frame. This frame is more of a window into your computer in the sense that you are able to view the packages and files that you have on stored on it. You can also use it to check any plots you might have and to read any documents on your computer as well. You only need to download a package one time, then it is saved. However, every time you open Rstudio packages must be loaded into the R environment.

```{r, echo=FALSE}
knitr::include_graphics("images/files_screenshot_example.png")
```

**Suggestion**: If you wish to change the layout of your frames to customize it simply click **tools** at the top of your computer then **global options** then to pane layout to customize the layout to whatever is the best for you.

## Packages and the tidyverse

Now that you are familiar with where you can view and access your packages we will take a closer look as to what they are and different tips for them as well as introducing you to the most useful package for working with data, the `tidyverse` .

### What is a package?

A package is where R gets its main power. We have packages because just like in real life they contain something. In R, packages can contain lots of different things. They are most useful because they provide us with functions that don't exist in base R - which is just R without any packages downloaded.

### Installing and finding packages

There are two ways to install packages.

1.  Via your files and packages pane.

    -   Click the packages tab in the Files/Packages pane

    -   Click the install button on the top left of that pane

    -   type "tidyverse"

    -   click install

2.  Via code.

    -   click to the right of the `>` symbol in your bottmo left console pane

    -   use the `install.packages()` function to install the desired package

    -   Once you are there you will type the following code. Do not be afraid if you see a warning in yellow that is perfectly normal.

```{r, eval=FALSE}
install.packages("psych")
```

### Loading packages

In order to access all the awesome functions within a package you must load it into the environment every single time.

You will want to do this by running the following in your source frame or the top left. We do this by using the the **library** function which calls up any package that you have installed it will not work if you do not have the package installed.

```{r, eval=FALSE}
library(tidyverse)
library(dplyr)
```

Once you have successfully loaded the tidyverse into your current session you should get the following result in your console:

```{r, echo=FALSE}
knitr::include_graphics("images/Tidyverse_load_example.png")
```

**THIS IS OK IT MEANS YOU HAVE SUCCESFULLY LOADED YOUR PACKAGE**

Now sometimes you will need to update your packages because if you don't it can cause them to not load and your code will not run. If this happens all you will have to do is run this code.

```{r, eval=FALSE}
update.packages()
```

To see what packages you have installed you can either go to the bottom right pane and find the packages tab to find a list of all packages and which are installed. Or you could also run this code.

```{r, eval=FALSE}
installed.packages()
```

### The Tidyverse

Now that you have successfully installed the **tidyverse** we can examine it and what it does. When thinking about the tidyverse the best way to explain it is think of it like a universe. A universe is a space that contains different things like planets which contain different things like people. Well just like a universe the tidyverse contains a large amount of packages inside of it that are meant to make using R easier and work more efficiently. All the packages inside the tidyverse all share a common philosophy and syntax. Think of it like the world having america and how we all share a common philosophy and syntax. The packages in the tidyverse work the same way. Because all of these functions use the same grammar it makes it easier for us to read R code. Take a look at this example

```{r, eval=FALSE}
library(tidyverse)

# Example of data transformation
starwars %>% 
  select(name, height, mass, species) %>% 
  filter(species == "human") %>% 
  arrange(desc(mass))
```

## Objects

In R, we will primarily be working with object. An object is a container that you label. It can bea single number, a giant dataset, a graph, a function or even models that we need. In order to create an object we use the `assignment operator`, it looks like an arrow pointing to the left `<-`. The `assignment operator` creates an object with the name of whatever is to the left of the operator and it will contain whatever is to the right of the operator.

```{r}
x <- 67 # object named x 
y <- "Good Morning" # object named y
```

If i make changes to an object that I want to keep, I must rewrite the original object or create a new one. If not, then my changes are not saved.

```{r}
x # open the x object

x + 3 # add three to get 70

x # x is still 67

x <-  x + 3 # make a new obejct named x using the old x object plus 3

x # the x object is 70 now
```

### Listing objects

If you ever want to see what your current objects are you can always look in your environment frame to see it. You can also use the list function `ls()` to see this as well.

```{r, eval=FALSE}
ls()
```

## Functions

Now that we are able to successfully load up packages we can start looking at some functions. A **function** is a command that begins an action. This is a basic example of a function. The function is made up of two arguments that we give values to.

```{r, eval=FALSE}
function_name(argument1 = value1, argument2 = value2)
```

### Applied Functions

Next we can look at a basic function called the **combine** function or it can be viewed as this `c()`. It takes every value we have in the function and applies it to all of them. This can be used for mathematical purposes when using Rstudio like a calculator. Lets take a look at an example.

```{r}
# Create object x that is a list of numbers
x <- (c(1, 2, 3, 4, 5)) 
```

### Arguments

Functions require certain information to carry out their actions. Arguments are where we provide that information. Many functions have default values automatically used for arguments. However, we often have to supply information for arguments, even if it's just the name of the object we want to use the function on. Arguments are separated by a comma. Let's look at the `sum` function. It has two arguments, the first is the data itself or the vector object containing the data and the second is `na.rm =` which has a default value of `FALSE`. `na.rm` is a logical argument asking if we want to remove data coded as NA, which could be missing data or incompatible data. Default arguments don't need to be typed out, they are implied, unless we want to give a value to the argment other than the default.

```{r, eval=FALSE}
x <- c( 1, 2, 3, 4, 5)
sum(x) # no need to specify na.rm here but what when we give it an NA value

y <- c(1, 2, 3, 4, 5, NA)
sum(y) # R can't calculate the sum if it doesn't know the value of NA
sum(y, na.rm = TRUE) # fixed
```

### Creating Functions

Creating your own function is a very useful skill because it allows you to easily apply values to data without you having to type it out over and over again. In order to create a function you must name it then assign it a value by using the `<-` symbol. This assigns whatever you write to that name which then should appear in the top right frame or your environment frame.

```{r}
plus_two <- function(x) {
  x + 2
}

plus_two(5)
```

We created the function `plus_two`, which will take whatever is in our function and add 2 to it so when we use the function and put 5 in there it takes 5 and already adds the two to it.

## Creating Data

### Vectors

A **vector** is a simple data structure that holds elements of the same kind. So if we want to combine a bunch of names we can use a vector to do so but they need to all be the same type of data. We will go over the different types of data later in the chapter. Here are some simple basic examples of vectors.

```{r}
numbers <- c(1, 2, 3, 4, 5, 6, 7)
names <- c("Adam", "Steven", "James")
```

Now once we have these saved as objects we can use them again if we want since we have combined them all into one vector.

```{r}
sum(numbers)
```

### Data Frames

A **data frame** is arranged into a rectangular shape and uses rows and columns. The columns in a data frame are called **variables** and the rows in our data frame are called **observations**. Now we can use data frames to combine two different types of data into one object. The `data.frame()` function creates this framework for us. We create columns and observations in this format:

```{r, eval=FALSE}
data.frame(
  column_1 = c(obs_1, obs_2, obs_3), 
  column_2 = c(obs_1, obs_2, obs_3)
)
```

Let's put some data in there.

```{r}
df <- data.frame(
  name = c("James", "Henry"),
  age = c(21,67),
  sport = c("Baseball", "Soccer")
)
```

Notice we have three columns and two observations. All information in a row is part of one observation. So, James is 21 and his sport is Baseball.

### Tibbles

A tribble is short for transposed tibble and it is a different way to create small data frames that looks more like a spreadsheet. It requires the `tibble` package to work, but that's part of the tidyverse so we should be ok. Some functions will only take data formatted as tibbles.

```{r}
library(tidyverse)

people <- tribble(
  ~name,   ~age, ~city,
  "James",  21,   "Evansville",
  "Hunter", 38,   "Toledo"
)

people
```

Now you can see our tribble fully completed with both rows and columns where you can see in the bottom of the output that the tribble shows the rows. It also tells us the type of data that we are seeing in the output which you will learn more about later in the chapter.

### Glimpse

When you want to examine the characteristics of your data you can use glimpse to get more information about it. It provides the full data for your set and gives all the details you could need.

```{r}
glimpse(people)
```

Look at the output above you can see next to name the `<chr>` that means the column contains data that is characters. The one below that is the `<dbl>` so you can see that is double data. This shows us that vectors simple a column of names and values that are the same type.

## Types of data

There are different types of data. In statistics we use numbers to represent all kinds of different things. We must differentiate between when a number 3 is epresenting a third category or the result of 1 + 2.

### Numeric and Double data

Numeric data is the type of data that we see that represents integers and "double precision floating point" numbers....or decimals. These are pretty common and are just regular numbers as you are familiar with them. They exist on a number line, can be multiplied and divided, and so on. Data formatted as numeric or double are on interval or ratio scales of measurement.

We can see if the data we are looking at is numeric/double by looking for how it is abbreviated. You can use the `typeof()` function in R to see exactly what type of data you are dealing with when you have a question about single objects, like below.

```{r}
typeof(42)
typeof(FALSE)
typeof("jack")
```

If we use the `glimipse` function, which tells us the format of an object and the first few observations in the object, we can see how we will more commonly interact with data formats.

```{r}
x <- c(1 , 2, 3, 4, 5)
glimpse(x)
```

### Character data

Character data is words that are not functions. Character data may also be referred to as "string" data. As behavioral scientists we may ask participants to write a response, this would be stored as character data. We can tell if the data is a character because it must always be in `"".` This shows that it is just text we are dealing with and not some function. The abbreviation for character data in R is `chr`.

```{r, eval=FALSE}
my_vector <- c("apple", "banana", "cherry")
typeof("apple")
glimpse(my_vector)
```

### Logical data

Logical data can only represent one of two values, `TRUE` or `FALSE`. Logical data will be represented in R as either `TRUE` or `FALSE`. It is important that they are all capitalized so they cannot be confused for something else. The abbreviations in R are simple because it will either be `T` or `F`.

```{r, eval=FALSE}
# Assigning logical values using full names
bool1 <- TRUE
bool2 <- FALSE
typeof(bool1)

# Assigning logical values using abbreviations
bool3 <- T
bool4 <- F
typeof(bool4)
```

### Factor data

Data are formatted as factors when we are referring to categories. It works with variables that have a fixed and already known set of possible values. We use factor data differently depending on the data we have. Data formatted as a factor can be on an ordinal scale or a nominal scale. We use `factor()` to create a new factor from a vector. We use `as.factor()` to move an object like a character list into a vector.

```{r, eval=FALSE}
college <- c("freshman", "sophomore", "junior", "senior")
glimpse(college) # notice that R formats this as a character vector

college_fct <- factor(college)
glimpse(college_fct) # now it is a factor, but the order of the levels is wrong

college_fct <- factor(college, levels = c("freshman", "sophomore", "junior", "senior"))
glimpse(college_fct) # now the order is right

# factors can also be numbers

data <-  c(1, 2, 3, 4, 5)
factor(data)
```

## The pipe

Now we will be working with the pipe or `|>`. The pipe is a very important tool because it works kind of like a river with bridges. Usually in R when we run multiple functions we would have to think of the output like a boat going through a river. Normally we would have to manually open each bridge in order for it to pass through to the next part of the river. The pipe makes it easier for us by doing that automatically. So whenever we are running multiple functions in a code chunk we use the pipe to channel the output right into the next function without having to do the work ourselves. In the tidyverse the pipe is represented as `%>%` which can be easily created with the shortcut ***command + shift + m.*** Now lets look at an example of how the pipe works.

```{r, eval=FALSE}
mtcars %>% 
  group_by(cyl) %>% 
  summarize(mean_mpg = mean(mpg))
```

```{r, echo=FALSE}
knitr::include_graphics("images/car_output.png")
```

You can see in the output now that in our pipe we took the car data set then funneled in the function of grouping cars by their cylinders then taking that output and funneling it into finding the average miles per gallon which creates our final output.

Now try running the same code without the use of the pipe and see if it still works.

## Tips and trouble shooting

When working with R there is always going to be something that will end up needing fixing or something will go wrong and you have no idea what to do. That is OK because there are a few different ways to figure things out when you need help.

### ? Tool

The question mark tool is a great too that can help explain anything you need. Lets say for example you don't know what a mean is. You can type in `?mean` and the help tab in your bottom right frame will open with whatever you need. It provides arguments and explanations as it is a great tool to help you figure things out.

```{r, eval=FALSE}
?mean
```

```{r, echo=FALSE}
knitr::include_graphics("images/help_info_sc.png")
```

### Help

The help function is another way to get info on objects you might be struggling with. It works the same as the question and can give you more information on it.

```{r, eval=FALSE}
help("mean")
```

### Traceback

Whenever we are working in R sometimes we might get an error. This can be confusing because R doesn't always tell you where you made this error it usually tells you what is wrong and when you are writing lots of code it can be difficult to find where you went wrong. Well you can use the `traceback()` function to find exactly where your code stopped working.

## Practice

Now that you learned the basic fundamentals of R and operating inside of it here are some practice problems to make yourself more comfortable with working in R

1.  Create a `tribble()` with four of your friends names, ages, and cities they are from

2.  Use `glimpse()` to inspect the data

3.  Write a function that doubles any number

4.  Use the pipe to select certain columns

5.  Find and list each columns type of data
